<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lyra Fletcher | Projects</title>

  <style>
    :root{
      --bg: #ffffff;
      --text: #121212;
      --muted: #5a5a5a;

      --accent: #ffd400;
      --accentSoft: rgba(255, 212, 0, 0.28);

      --border: rgba(0,0,0,0.09);

      --shadowGlow: 0 0 0.9rem rgba(255, 212, 0, 0.55),
                    0 0 2.4rem rgba(255, 212, 0, 0.25);

      --shadowSoft: 0 10px 30px rgba(0,0,0,0.06);

      --radius: 18px;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body{
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    .wrap{
      width: min(1100px, 92vw);
      margin: 0 auto;
      padding: 28px 0 60px;
    }

    header{
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 18px;
    }

    .name{
      font-size: clamp(30px, 4.5vw, 44px);
      letter-spacing: -0.02em;
      margin: 0;
    }

    .toplinks{
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .pill{
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      text-decoration: none;
      color: var(--text);
      background: #fff;
      box-shadow: 0 0 0.7rem rgba(255, 212, 0, 0.18);
      transition: transform .15s ease, box-shadow .15s ease;
      font-weight: 600;
      font-size: 14px;
    }
    .pill:hover{
      transform: translateY(-1px);
      box-shadow: var(--shadowGlow);
    }

    .about{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: #fff;
      box-shadow: var(--shadowGlow);
      padding: 18px 18px 16px;
      position: relative;
      overflow: hidden;
      margin-bottom: 22px;
    }

    .about::before{
      content:"";
      position:absolute;
      inset: -120px auto auto -120px;
      width: 260px;
      height: 260px;
      background: radial-gradient(circle, var(--accentSoft), transparent 65%);
      filter: blur(2px);
      pointer-events:none;
    }

    .about-grid{
      display: grid;
      gap: 16px;
      grid-template-columns: 1.2fr 0.8fr;
    }

    @media (max-width: 860px){
      .about-grid{ grid-template-columns: 1fr; }
      header{ align-items: flex-start; flex-direction: column; }
      .toplinks{ justify-content: flex-start; }
    }

    .about h2{
      margin: 0 0 10px 0;
      font-size: 18px;
      letter-spacing: -0.01em;
    }

    .about p{
      margin: 0;
      color: var(--muted);
      line-height: 1.55;
    }

    .meta{
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 14px;
      padding: 14px;
      background: #fff;
      box-shadow: var(--shadowSoft);
    }

    .meta h3{
      margin: 0 0 10px 0;
      font-size: 14px;
      letter-spacing: 0.02em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .meta dl{
      margin: 0;
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
      font-size: 14px;
    }

    .meta dt{
      font-weight: 700;
      margin-bottom: 2px;
    }
    .meta dd{
      margin: 0;
      color: var(--muted);
    }

    .cv-link{
      display: inline-flex;
      margin-top: 10px;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      text-decoration: none;
      color: var(--text);
      border-bottom: 2px solid rgba(255, 212, 0, 0.65);
      width: fit-content;
      padding-bottom: 2px;
    }
    .cv-link:hover{
      border-bottom-color: var(--accent);
    }

    .section-title{
      display:flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 14px;
      margin: 18px 0 12px;
    }
    .section-title h2{
      margin: 0;
      font-size: 18px;
      letter-spacing: -0.01em;
    }
    .section-title small{
      color: var(--muted);
    }

    .grid{
      display: grid;
      gap: 14px;
      grid-template-columns: repeat(4, 1fr);
    }
    @media (max-width: 1020px){
      .grid{ grid-template-columns: repeat(3, 1fr); }
    }
    @media (max-width: 720px){
      .grid{ grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 460px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: #fff;
      box-shadow: 0 0 0.8rem rgba(255, 212, 0, 0.20);
      overflow: hidden;
      cursor: pointer;
      transition: transform .15s ease, box-shadow .15s ease;
      display: flex;
      flex-direction: column;
      min-height: 190px;
    }
    .card:hover{
      transform: translateY(-2px);
      box-shadow: var(--shadowGlow);
    }

    .thumb{
      height: 110px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255, 212, 0, 0.30), transparent 55%),
        linear-gradient(135deg, rgba(0,0,0,0.04), rgba(0,0,0,0.02));
      display: grid;
      place-items: center;
      border-bottom: 1px solid rgba(0,0,0,0.06);
      position: relative;
      overflow: hidden;
    }
      
      .thumb img{
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

    .thumb span{
      font-size: 12px;
      color: rgba(0,0,0,0.55);
      font-weight: 700;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      padding: 6px 10px;
      border: 1px dashed rgba(0,0,0,0.22);
      border-radius: 999px;
      background: rgba(255,255,255,0.6);
      backdrop-filter: blur(4px);
    }

    .card-body{
      padding: 12px 12px 14px;
      display:flex;
      flex-direction: column;
      gap: 8px;
      flex: 1;
    }

    .card-title{
      margin: 0;
      font-size: 14px;
      letter-spacing: -0.01em;
    }
    .card-sub{
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .card-footer{
      margin-top: auto;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      color: rgba(0,0,0,0.55);
      font-size: 12px;
    }

    .site-footer{
      width: min(1100px, 92vw);
      margin: 28px auto 0;
      padding: 14px 16px;
      text-align: center;
      color: rgba(0,0,0,0.60);
      font-size: 13px;
      border: 1px solid rgba(0,0,0,0.09);
      border-radius: 16px;
      background: #fff;
      box-shadow: 0 0 0.7rem rgba(255, 212, 0, 0.18);
    }

    .backdrop{
      position: fixed;
      inset: 0;
      background: rgba(10,10,10,0.45);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      z-index: 50;
    }
    .backdrop.show{ display: flex; }

    .modal{
      width: min(820px, 100%);
      background: #fff;
      border-radius: 20px;
      border: 1px solid rgba(255, 212, 0, 0.35);
      box-shadow: 0 0 1.2rem rgba(255, 212, 0, 0.65),
                  0 24px 60px rgba(0,0,0,0.25);
      overflow: hidden;
      position: relative;
    }

    .modal-header{
      padding: 16px 18px;
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 12px;
      border-bottom: 1px solid rgba(0,0,0,0.08);
      background:
        radial-gradient(circle at 15% 30%, rgba(255, 212, 0, 0.25), transparent 55%),
        #fff;
    }

    .modal-title{
      margin: 0;
      font-size: 18px;
      letter-spacing: -0.01em;
    }

    .close{
      border: 1px solid rgba(0,0,0,0.12);
      background: #fff;
      border-radius: 12px;
      padding: 8px 10px;
      font-weight: 800;
      cursor: pointer;
      box-shadow: 0 0 0.7rem rgba(255, 212, 0, 0.18);
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .close:hover{
      transform: translateY(-1px);
      box-shadow: var(--shadowGlow);
    }

    .modal-content{
      padding: 16px 18px 0;
      display: grid;
      grid-template-columns: 1fr 0.9fr;
      gap: 16px;
    }

    @media (max-width: 900px){
      .modal-content{ grid-template-columns: 1fr; }
    }

    .modal-image{
      border: 1px solid rgba(0,0,0,0.10);
      border-radius: 16px;
      overflow: hidden;
      min-height: 220px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255, 212, 0, 0.30), transparent 55%),
        linear-gradient(135deg, rgba(0,0,0,0.05), rgba(0,0,0,0.02));
      display: grid;
      place-items: center;
      box-shadow: var(--shadowSoft);
    }
    /* ✅ changed display: none -> block so modal images size correctly */
    .modal-image img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .modal-image .placeholder{
      text-align: center;
      color: rgba(0,0,0,0.55);
      font-weight: 800;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      font-size: 12px;
      padding: 10px 12px;
      border: 1px dashed rgba(0,0,0,0.22);
      border-radius: 999px;
      background: rgba(255,255,255,0.65);
      backdrop-filter: blur(4px);
    }

    .modal-text{
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 16px;
      padding: 14px;
      box-shadow: var(--shadowSoft);
    }
    .modal-text h3{
      margin: 0 0 8px 0;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.03em;
      color: var(--muted);
    }
    .modal-text p{
      margin: 0;
      line-height: 1.55;
      color: var(--text);
      font-size: 14px;
    }

    .modal-footer{
      margin-top: 14px;
      padding: 14px 18px 18px;
      border-top: 1px solid rgba(0,0,0,0.08);
      background: #fff;
    }

    .skills-row{
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .tag{
      border: 1px solid rgba(0,0,0,0.12);
      border-radius: 999px;
      padding: 8px 10px;
      font-size: 13px;
      background: #fff;
      box-shadow: 0 0 0.6rem rgba(255, 212, 0, 0.14);
      font-weight: 650;
    }

    .sr-only{
      position:absolute;
      width:1px;
      height:1px;
      padding:0;
      margin:-1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }
  </style>
</head>

<body>
  <div class="wrap">

    <header>
      <h1 class="name">Lyra Fletcher</h1>

      <nav class="toplinks" aria-label="Top links">
        <a class="pill" href="index.html">← Home</a>
        <a class="pill" href="main.html">Projects</a>
        <a class="pill" href="experience.html">Experience</a>
        <a class="pill" href="media.html">Media</a>

        <a class="pill" href="./Lyra_Fletcher_CV_2026.pdf" target="_blank" rel="noopener">Open CV</a>
        <a class="pill" href="mailto:lyrafletcher@outlook.com">Email</a>
      </nav>
    </header>

    <section class="about" aria-label="About me">
      <div class="about-grid">
        <div>
          <h2>About Me</h2>
          <p>
            I’m a third-year Mechatronics-Mechanical Engineering student at UBC with a passion for designing user-centered systems that improve accessibility and quality of life. I’m especially interested in the intersection of robotics, manufacturing, and real-world impact, whether in healthcare or creative technology. I’m seeking hands-on roles and projects where I can take ideas from concept to prototype, collaborate with multidisciplinary teams, and contribute to products that make a meaningful difference.
          </p>
        </div>

        <aside class="meta" aria-label="Education and details">
          <h3>Education</h3>
          <dl>
            <div>
              <dt>University</dt>
              <dd>University of British Columbia — Mechatronics / Mechanical Engineering</dd>
              <dd><em>Minor in Entrepreneurship</em></dd>
            </div>
            <div>
              <dt>CGPA</dt>
              <dd>87.5%</dd>
            </div>
            <div>
              <dt>Avaliability</dt>
              <dd>May 2026 - (End of) August 2026</dd>
            </div>
            <div>
              <dt>Highlights</dt>
              <dd>
                <ul style="margin: 6px 0 0 16px; padding: 0;">
                  <li>UBC Thunderbikes Mechanical Lead (2022)</li>
                  <li>UBC Schulich Scholar ($80,000)</li>
                  <li>Biomedical Entrance Scholar ($25,000)</li>
                </ul>
              </dd>
            </div>
          </dl>

          <a class="cv-link" href="./Lyra_Fletcher_CV_2026.pdf" target="_blank" rel="noopener">Link to my CV →</a>
        </aside>
      </div>
    </section>

    <div class="section-title">
      <h2>Projects</h2>
      <small>Click a project to view details + key skills</small>
    </div>

    <section class="grid" id="projectGrid" aria-label="Project grid"></section>
  </div>

  <div class="backdrop" id="backdrop" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal" role="document">
      <div class="modal-header">
        <div>
          <h2 class="modal-title" id="modalTitle">Project Title</h2>
          <span class="sr-only" id="modalDescLabel">Project description</span>
        </div>
        <button class="close" id="closeBtn" type="button" aria-label="Close project details">✕</button>
      </div>

      <div class="modal-content">
        <div class="modal-image" id="modalImageWrap" aria-label="Project image">
          <img id="modalImage" alt="Project image" />
          <div class="placeholder" id="modalImagePlaceholder">Photo Placeholder</div>
        </div>

        <div class="modal-text" aria-describedby="modalDescLabel">
          <h3>Description</h3>
          <p id="modalDescription">Project description goes here.</p>
        </div>
      </div>

      <div class="modal-footer">
        <h3 style="margin:0 0 10px 0; font-size:14px; text-transform:uppercase; letter-spacing:0.03em; color: var(--muted);">
          Key Skills
        </h3>
        <div class="skills-row" id="modalSkills"></div>
      </div>
    </div>
  </div>

  <script>
    // ---------------------------
    // Data (unchanged)
    // ---------------------------
    const projects = [
      {
        id: 1,
        title: "Automated Naloxone Injector",
        short: "Prototyped an automated injection device concept to improve overdose response speed and usability.",
        description:
          "Designed an automated naloxone injector proof-of-concept exploring rapid deployment and reduced user steps in emergency overdose response scenarios. Developed a compact actuation architecture using a horizontal needle orientation and curved delivery pathway to minimize device profile and support wearable packaging. Designed the Arduino–linear actuator control architecture and enclosure layout, iterating housing geometry in SolidWorks and fabricating prototype enclosures via Bambu Studio 3D printing. Explored overdose detection concepts through hypoxic analysis using pulse oximetry. Built an Arduino-based wrist oximeter to collect SpO₂ biometrics and evaluated how abnormal oxygen saturation trends could inform automated response logic at a prototype systems level.",
        imageUrl: "./images/project1.jpg",
        skills: [
          "Medical Device Design",
          "Actuation & Mechanisms",
          "SolidWorks",
          "3D Printing",
          "PCB Packaging",
          "Risk & Safety Thinking",
          "Arduino",
          "Biometrics (Pulse Oximetry)"
        ]
      },
      {
        id: 2,
        title: "Topographical CNC Coffee Table",
        short: "Created a CAD-to-CAM workflow to fabricate a topography-inspired table using CNC machining.",
        description:
          "Designed a topographical coffee table using contour-style surface geometry and manufactured it via CNC machining. Built the model in CAD with a focus on toolpath-friendly geometry, consistent stepdown features, and structural stiffness for a furniture-scale assembly. Generated CAM operations to balance surface finish and machining time, accounting for cutter selection, feed/speed constraints, and finishing passes to achieve clean contour fidelity.",
        imageUrl: "./images/project2.jpg",
        skills: [
          "CAD",
          "CAM",
          "CNC Machining",
          "Toolpath Planning",
          "DFM",
          "Manufacturing"
        ]
      },
      {
        id: 3,
        title: "RGB Mixing and Brightening Light Pipe",
        short: "Designed production-ready optical light pipes to improve RGB mixing and brightness in hardware.",
        description:
          "Designed and released production-ready optical light pipes to improve RGB LED color uniformity and brightness in Pro AV hardware. Performed DFMA and injection molding feasibility analysis, considering draft, gate placement constraints, parting line strategy, and tolerance stack-up for consistent assembly. Released CAD and drawings for manufacturing while coordinating with electrical, manufacturing, and compliance stakeholders through prototype-to-production iterations.",
        imageUrl: "./images/project3.jpg",
        skills: [
          "Optical Component Design",
          "DFMA",
          "Injection Molding",
          "Creo CAD",
          "Tolerance & Fit",
          "Cross-Functional Collaboration",
          "Product Release"
        ]
      },
      {
        id: 4,
        title: "UV Resin Curing Rig",
        short: "Built a UV curing system to safely solidify resin waste for compliant disposal.",
        description:
          "Designed and implemented a UV resin curing system to solidify waste resin for safe handling and disposal. Integrated enclosure design, UV exposure considerations, and operational workflow to reduce hazardous waste risk and improve lab safety practices. Focused on reliability and safe user interaction, including controlled curing exposure and straightforward maintenance for repeated use.",
        imageUrl: "./images/project4.jpg",
        skills: [
          "System Design",
          "Prototyping",
          "Safety Engineering",
          "Design for Use",
          "Fabrication"
        ]
      },
      {
        id: 5,
        title: "Vacuum Screen Assembly Rig",
        short: "Designed a venturi-driven vacuum fixture to speed assembly and reduce screen handling waste.",
        description:
          "Developed a vacuum-assisted screen assembly system using relays and venturi-based pneumatics to stabilize and position screens during assembly. Designed the mechanical fixture and control logic to reduce handling variability and improve repeatability on the line. Increased production speed by 10% while reducing material waste through more reliable placement and fewer rework cycles.",
        imageUrl: "./images/project5.jpg",
        skills: [
          "Pneumatics (Venturi)",
          "Fixture Design",
          "Relays & Controls",
          "Process Improvement",
          "Manufacturing Support",
          "Prototyping"
        ]
      },
      {
        id: 6,
        title: "i-PEX PCB Connector Assembly Tool",
        short: "Designed and FEA-validated custom assembly tooling to improve ergonomics and consistency.",
        description:
          "Designed and FEA-validated a custom i-PEX PCB connector assembly tool in Creo to improve alignment and reduce operator strain. Optimized geometry for stiffness and repeatable load paths during connector engagement, then validated stress/deflection performance under expected assembly forces. Reduced assembly time by 15% while improving manufacturing consistency and ergonomics for daily use on the production line.",
        imageUrl: "./images/project6.jpg",
        skills: [
          "Creo CAD",
          "FEA",
          "Tooling Design",
          "Ergonomics",
          "Manufacturing Consistency",
          "Engineering Drawings"
        ]
      },
      {
        id: 7,
        title: "Car Distance Sensor",
        short: "Built an Arduino + ultrasonic parking aid with Bluetooth display and error-compensated ranging.",
        description:
          "Developed a forward-stall parking assistance tool that provides real-time distance measurements from the front bumper to obstacles. Integrated ultrasonic distance sensors with an Arduino-based controller and a Bluetooth display, packaged inside a custom-designed enclosure manufactured via Bambu Lab 3D printing. Developed MATLAB and Python algorithms to improve range accuracy and compensate for geometric effects (including parallax/offset mounting), producing a reliable, user-friendly distance readout for improved parking precision.",
        imageUrl: "./images/project7.png",
        skills: [
          "Arduino",
          "Ultrasonic Sensing",
          "Embedded Systems",
          "MATLAB",
          "Python",
          "Bluetooth Integration",
          "Enclosure Design",
          "3D Printing"
        ]
      },
      {
        id: 8,
        title: "Google Home Integrated Watering Line",
        short: "Built a smart watering system integrated with voice control and automated scheduling.",
        description:
          "Designed a smart watering line integrated with Google Home for voice control and automation. Implemented control electronics for valve actuation and created reliable on/off scheduling logic for repeatable watering cycles. Focused on robustness for real-world use, including stable power and enclosure considerations for operating in outdoor/utility environments.",
        imageUrl: "./images/google-home-watering.jpg",
        skills: [
          "IoT",
          "Automation",
          "Systems Integration",
          "Electronics",
          "Prototyping",
          "Reliability"
        ]
      },
      {
        id: 9,
        title: "Cooling Plate Analysis",
        short: "Modeled heat transfer to reduce thermal gradients and validate high heat-removal battery plates.",
        description:
          "Modeled and validated battery cooling plate performance using Python and MATLAB to quantify conduction paths, convective boundary conditions, and thermal gradients across battery segments. Used simulation outputs to drive geometry/material decisions and predict plate-level heat removal capability. Achieved up to 8 kW heat removal per battery section with improved thermal uniformity, supporting pack reliability under short-duration, high-load race conditions.",
        imageUrl: "./images/project9.png",
        skills: [
          "Heat Transfer",
          "Thermal Modeling",
          "Python",
          "MATLAB",
          "Design Optimization",
          "Data Analysis"
        ]
      },
      {
        id: 10,
        title: "Turbulent Hose Connectors for Cooling System",
        short: "Designed and machined custom stepped adapters that induce turbulence for improved heat transfer.",
        description:
          "Designed and manufactured custom cooling hose adapters to interface mismatched inlet/outlet diameters across a multi-component liquid cooling loop (motor, motor controller, radiators, pump, battery plates). Machined stepped adapters on a lathe and incorporated internal geometric features to promote turbulence, improving convective heat transfer and reducing thermal bottlenecks. Iterated designs based on fit, sealing, and flow behavior to support reliable integration across the full cooling circuit.",
        imageUrl: "./images/project10.png",
        skills: [
          "Fluid Systems",
          "Lathe Machining",
          "Adapter Design",
          "Thermal Systems",
          "DFM",
          "Integration"
        ]
      },
      {
        id: 11,
        title: "Battery Case Design and Assembly",
        short: "Designed and built the battery enclosure for the team’s first competition motorcycle iteration.",
        description:
          "Designed, manufactured, and assembled the battery enclosure for UBC Thunder Bikes’ first motorcycle iteration, prioritizing structural integrity, electrical isolation, and serviceability. Supported fabrication using a chop saw for part prep, MIG welding for steel structures, and post-processing via angle grinding to refine welds and fit. Coordinated assembly integration to ensure packaging compatibility with surrounding systems and safe handling during competition operations.",
        imageUrl: "./images/project11.png",
        skills: [
          "Mechanical Design",
          "Fabrication",
          "MIG Welding",
          "Assembly",
          "Battery Safety",
          "Manufacturing"
        ]
      },
      {
        id: 12,
        title: "Resin Waste Water Filtration & Settling System",
        short: "Designed a modular filtration and settling system to prevent uncured resin from entering wastewater.",
        description:
          "Designed and implemented a modular water filtration and settling system to capture uncured resin and particulates before wastewater discharge. Modeled and 3D-printed custom bulkheads and NPT fittings to integrate with existing lab plumbing, enabling tool-free disassembly and cleaning. Engineered a gravity-driven settling chamber to promote particulate sedimentation and staged filtration, reducing environmental impact and improving compliance with lab safety and waste-handling practices.",
        imageUrl: "./images/project12.jpg",
        skills: [
          "Environmental Systems",
          "CAD",
          "3D Printing",
          "Fluid Handling",
          "NPT Fittings",
          "DFM",
          "Lab Safety",
          "Sustainable Design"
        ]
      }
    ];

    document.addEventListener("DOMContentLoaded", () => {
      const grid = document.getElementById("projectGrid");
      const backdrop = document.getElementById("backdrop");
      const closeBtn = document.getElementById("closeBtn");

      const modalTitle = document.getElementById("modalTitle");
      const modalDescription = document.getElementById("modalDescription");
      const modalSkills = document.getElementById("modalSkills");
      const modalImage = document.getElementById("modalImage");
      const modalImagePlaceholder = document.getElementById("modalImagePlaceholder");

      function escapeHtml(str) {
        return String(str ?? "")
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      function renderCards() {
        if (!grid) return;
        grid.innerHTML = "";

        projects.forEach((p) => {
          const card = document.createElement("article");
          card.className = "card";
          card.tabIndex = 0;
          card.setAttribute("role", "button");
          card.setAttribute("aria-label", `Open details for ${p.title}`);
          card.dataset.projectId = String(p.id); // ✅ key for event delegation

          const thumb = document.createElement("div");
          thumb.className = "thumb";

          const badge = document.createElement("span");
          badge.textContent = "Photo Placeholder";

          const imgSrc = (p.imageUrl || "").trim();
          if (imgSrc) {
            const img = document.createElement("img");
            img.src = imgSrc;
            img.alt = `${p.title} thumbnail`;
            img.loading = "lazy";
            img.decoding = "async";

            img.addEventListener("error", () => {
              img.style.display = "none";
              badge.style.display = "inline-flex";
            });

            thumb.appendChild(img);
            badge.style.display = "none";
          }

          thumb.appendChild(badge);

          const body = document.createElement("div");
          body.className = "card-body";
          body.innerHTML = `
            <h3 class="card-title">${escapeHtml(p.title)}</h3>
            <p class="card-sub">${escapeHtml(p.short)}</p>
            <div class="card-footer">
              <span>#${String(p.id).padStart(2, "0")}</span>
              <span>View →</span>
            </div>
          `;

          card.appendChild(thumb);
          card.appendChild(body);
          grid.appendChild(card);
        });
      }

      function openModal(project) {
        // ✅ If any modal element is missing, don't crash
        if (!backdrop || !modalTitle || !modalDescription || !modalSkills || !modalImage || !modalImagePlaceholder) {
          console.error("Modal elements missing. Check IDs in uploaded GitHub file.");
          return;
        }

        modalTitle.textContent = project.title;
        modalDescription.textContent = project.description;

        modalSkills.innerHTML = "";
        (project.skills || []).forEach((s) => {
          const tag = document.createElement("span");
          tag.className = "tag";
          tag.textContent = s;
          modalSkills.appendChild(tag);
        });

        const url = (project.imageUrl || "").trim();
        if (url) {
          modalImage.src = url;
          modalImage.style.display = "block";
          modalImagePlaceholder.style.display = "none";

          modalImage.onerror = () => {
            modalImage.onerror = null;
            modalImage.style.display = "none";
            modalImagePlaceholder.style.display = "inline-flex";
          };
        } else {
          modalImage.removeAttribute("src");
          modalImage.style.display = "none";
          modalImagePlaceholder.style.display = "inline-flex";
        }

        backdrop.classList.add("show");
        document.body.style.overflow = "hidden";
        if (closeBtn) closeBtn.focus();
      }

      function closeModal() {
        if (!backdrop) return;
        backdrop.classList.remove("show");
        document.body.style.overflow = "";
      }

      // ✅ Event delegation: one listener handles all cards (most reliable)
      grid?.addEventListener("click", (e) => {
        const card = e.target.closest(".card");
        if (!card) return;

        const id = Number(card.dataset.projectId);
        const project = projects.find(p => p.id === id);
        if (project) openModal(project);
      });

      grid?.addEventListener("keydown", (e) => {
        if (e.key !== "Enter" && e.key !== " ") return;
        const card = e.target.closest(".card");
        if (!card) return;

        e.preventDefault();
        const id = Number(card.dataset.projectId);
        const project = projects.find(p => p.id === id);
        if (project) openModal(project);
      });

      backdrop?.addEventListener("click", (e) => {
        if (e.target === backdrop) closeModal();
      });

      closeBtn?.addEventListener("click", closeModal);

      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && backdrop?.classList.contains("show")) closeModal();
      });

      renderCards();
    });
  </script>

  <footer class="site-footer">© Lyra Fletcher 2026</footer>
</body>
</html>
